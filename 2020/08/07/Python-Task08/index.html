<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  

  
  <title>Python-Task08 | Hexo</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="Python编程基础-Task08Task 8:模块与datetime模块模块 1.模块    ​    模块是一个包含所有你定义的函数和变量的文件，其后缀名是.py。模块可以被别的程序引入，以使用该模块中的函数等功能。这也是使用 python 标准库的方法。  容器 -&gt; 数据的封装 函数 -&gt; 语句的封装 类 -&gt; 方法和属性的封装 模块 -&gt; 程序文件  2.命名空间">
<meta property="og:type" content="article">
<meta property="og:title" content="Python-Task08">
<meta property="og:url" content="http://yoursite.com/2020/08/07/Python-Task08/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:description" content="Python编程基础-Task08Task 8:模块与datetime模块模块 1.模块    ​    模块是一个包含所有你定义的函数和变量的文件，其后缀名是.py。模块可以被别的程序引入，以使用该模块中的函数等功能。这也是使用 python 标准库的方法。  容器 -&gt; 数据的封装 函数 -&gt; 语句的封装 类 -&gt; 方法和属性的封装 模块 -&gt; 程序文件  2.命名空间">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://www.runoob.com/wp-content/uploads/2014/05/types_namespace-1.png">
<meta property="og:image" content="https://www.runoob.com/wp-content/uploads/2014/05/1418490-20180906153626089-1835444372.png">
<meta property="article:published_time" content="2020-08-07T03:08:22.000Z">
<meta property="article:modified_time" content="2020-08-17T07:22:05.007Z">
<meta property="article:author" content="John Doe">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://www.runoob.com/wp-content/uploads/2014/05/types_namespace-1.png">
  
    <link rel="alternate" href="/atom.xml" title="Hexo" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  
<link rel="stylesheet" href="/css/style.css">

<meta name="generator" content="Hexo 4.2.1"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Hexo</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://yoursite.com"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main"><article id="post-Python-Task08" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2020/08/07/Python-Task08/" class="article-date">
  <time datetime="2020-08-07T03:08:22.000Z" itemprop="datePublished">2020-08-07</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      Python-Task08
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="Python编程基础-Task08"><a href="#Python编程基础-Task08" class="headerlink" title="Python编程基础-Task08"></a>Python编程基础-Task08</h1><h2 id="Task-8-模块与datetime模块"><a href="#Task-8-模块与datetime模块" class="headerlink" title="Task 8:模块与datetime模块"></a>Task 8:模块与datetime模块</h2><p><strong>模块</strong></p>
<p>1.模块   </p>
<p>​    模块是一个包含所有你定义的函数和变量的文件，其后缀名是.py。模块可以被别的程序引入，以使用该模块中的函数等功能。这也是使用 python 标准库的方法。</p>
<ul>
<li>容器 -&gt; 数据的封装</li>
<li>函数 -&gt; 语句的封装</li>
<li>类 -&gt; 方法和属性的封装</li>
<li>模块 -&gt; 程序文件</li>
</ul>
<p>2.命名空间</p>
<p>​    命名空间（namespace）是从名称到对象的映射，大部分命名空间都是通过Python字典来实现的。命名空间提供了在项目中避免名字冲突的一种方法。各个命名空间是独立的，没有任何关系的，所以一个命名空间中不能有重名，但不同的命名空间是可以重名而没有任何影响。</p>
<p>因为对象的不同，也有所区别，可以分为如下几种：</p>
<ul>
<li>内置命名空间（Built-in Namespaces）：Python语言内置的名称，Python 运行起来，它们就存在了。内置函数的命名空间都属于内置命名空间，所以，我们可以在任何程序中直接运行它们，比如<code>id()</code>,不需要做什么操作，拿过来就直接使用了。</li>
<li>全局命名空间（Module：Global Namespaces）：模块中定义的名称，记录了模块的变量，包括函数、类、其他导入的模块、模块级的变量和常量。每个模块创建它自己所拥有的全局命名空间，不同模块的全局命名空间彼此独立，不同模块中相同名称的命名空间，也会因为模块的不同而不相互干扰。</li>
<li>本地命名空间（Function &amp; Class：Local Namespaces）：函数中定义的名称，记录了函数的变量，包括函数的参数和局部定义的变量。模块中有函数或者类，每个函数或者类所定义的命名空间就是本地命名空间。如果函数返回了结果或者抛出异常，则本地命名空间也结束了。</li>
</ul>
<img src="https://www.runoob.com/wp-content/uploads/2014/05/types_namespace-1.png" alt="img" style="zoom:50%;" />

<p>命名空间查找顺序:按照从里到外的顺序，为：<strong>局部的命名空间去 -&gt; 全局命名空间 -&gt; 内置命名空间</strong>。</p>
<p>如果找不到变量 ，它将放弃查找并引发一个 NameError 异常</p>
<p>命名空间的生命周期：命名空间的生命周期取决于对象的作用域，如果对象执行完成，则该命名空间的生命周期就结束。因此，我们无法从外部命名空间访问内部命名空间的对象。</p>
<p>作用域：作用域就是一个 Python 程序可以直接访问命名空间的正文区域。</p>
<p>变量的作用域决定了在哪一部分程序可以访问哪个特定的变量名称。Python的作用域一共有4种，分别是：</p>
<p>有四种作用域：</p>
<ul>
<li><strong>L（Local）</strong>：最内层，包含局部变量，比如一个函数/方法内部。</li>
<li><strong>E（Enclosing）</strong>：包含了非局部(non-local)也非全局(non-global)的变量。比如两个嵌套函数，一个函数（或类） A 里面又包含了一个函数 B ，那么对于 B 中的名称来说 A 中的作用域就为 nonlocal。</li>
<li><strong>G（Global）</strong>：当前脚本的最外层，比如当前模块的全局变量。</li>
<li><strong>B（Built-in）</strong>： 包含了内建的变量/关键字等。，最后被搜索</li>
</ul>
<p>规则顺序： <strong>L –&gt; E –&gt; G –&gt;gt; B</strong>。</p>
<p>在局部找不到，便会去局部外的局部找（例如闭包），再找不到就会去全局找，再者去内置中找。</p>
<p><img src="https://www.runoob.com/wp-content/uploads/2014/05/1418490-20180906153626089-1835444372.png" alt="img"></p>
<p>3.导入模块</p>
<p>第一种：import 模块名</p>
<p>第二种：from 模块名 import 函数名</p>
<p>第三种：import 模块名 as 新名字</p>
<p><strong>比如引入同一目录下的py文件：</strong></p>
<p>例如在admin.py文件中要引入dealcode.py文件：</p>
<p>1)在目录下有<strong>init</strong>.py文件</p>
<p>2)在admin.py文件中加一行：from . import dealcode</p>
<p>（如果要引入同一目录下的dealcode.py文件中的一个类Hello，在admin.py文件中加一行：from .dealcode import Hello）</p>
<p>引入同级目录文件夹的下级文件：from .templateminer import lenma_template</p>
<p>（一定要加.）</p>
<p>from .. import module_name：导入本模块上一级目录的模块。</p>
<p>from ..package_name import module_name。导入本模块上一级目录下的包中的模块。</p>
<p>但需要注意：</p>
<p>需要执行main的模块中，将相对引用改为绝对引用。较常见的比如单元测试类中的导入。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> .package <span class="keyword">import</span> mymodule</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__==<span class="string">"__main__"</span>:</span><br><span class="line">   do_something()</span><br></pre></td></tr></table></figure>

<p>更改：</p>
<p>比较简单的一种是将”.”之前加上文件夹的名字，形如：</p>
<p>​    from my_dir.package import mymodule   或者  from package import mymodule</p>
<p>分析：</p>
<p>在main函数中执行时，<strong>name</strong>这个变量值是”<strong>main</strong>”。而相对引用符号”.”的就是对应<strong>name</strong>这个变量。</p>
<p>当这个模块是在别的模块中被导入使用，此时的”.”就是原模块的文件名。在main函数中执行时，此时”.”变成了”<strong>main</strong>”。所以，出现了这个问题。</p>
<p>4.<code>if __name__ == &#39;__main__&#39;</code></p>
<p><code>__name__</code>：是内置变量，可用于表示当前模块的名字。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> const</span><br><span class="line"></span><br><span class="line">print(__name__)</span><br><span class="line"><span class="comment"># __main__</span></span><br><span class="line"></span><br><span class="line">print(const.__name__)</span><br><span class="line"><span class="comment"># const</span></span><br></pre></td></tr></table></figure>

<p>​    由此我们可知：如果一个 .py 文件（模块）被直接运行时，其<code>__name__</code>值为<code>__main__</code>，即模块名为<code>__main__</code>。</p>
<p>所以，<code>if __name__ == &#39;__main__&#39;</code>的意思是：当 .py 文件被直接运行时，<code>if __name__ == &#39;__main__&#39;</code>之下的代码块将被运行；当 .py 文件以模块形式被导入时，<code>if __name__ == &#39;__main__&#39;</code>之下的代码块不被运行。</p>
<p>5.搜索路径</p>
<p>当解释器遇到 import 语句，如果模块在当前的搜索路径就会被导入。</p>
<p>当我们使用import语句的时候，Python解释器是怎样找到对应的文件的呢？</p>
<p>这就涉及到Python的搜索路径，搜索路径是由一系列目录名组成的，Python解释器就依次从这些目录中去寻找所引入的模块。这看起来很像环境变量，事实上，也可以通过定义环境变量的方式来确定搜索路径。</p>
<p>搜索路径是在Python编译或安装的时候确定的，安装新的库应该也会修改。搜索路径被存储在sys模块中的path变量：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"></span><br><span class="line">print(sys.path)</span><br><span class="line"><span class="comment"># ['C:\\ProgramData\\Anaconda3\\DLLs', 'C:\\ProgramData\\Anaconda3\\lib', 'C:\\ProgramData\\Anaconda3', 'C:\\ProgramData\\Anaconda3\\lib\\site-packages',...]</span></span><br></pre></td></tr></table></figure>

<p>6.包</p>
<p>包是一种管理 Python 模块命名空间的形式，采用”点模块名称”。</p>
<p>创建包分为三个步骤：</p>
<ul>
<li><p>创建一个文件夹，用于存放相关的模块，文件夹的名字即包的名字。</p>
</li>
<li><p>在文件夹中创建一个 <code>__init__.py</code> 的模块文件，内容可以为空。</p>
</li>
<li><p>将相关的模块放入文件夹中。</p>
</li>
</ul>
<p>如果我们使用 <code>from sound.effects import *</code>，Python 会进入文件系统，找到这个包里面所有的子模块，一个一个的把它们都导入进来。</p>
<p>导入语句遵循如下规则：如果包定义文件 <code>__init__.py</code> 存在一个叫做 <code>__all__</code> 的列表变量，那么在使用 <code>from package import *</code> 的时候就把这个列表中的所有名字作为包内容导入。</p>
<p>例如，在 <code>sounds/effects/__init__.py</code>中包含如下代码：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">__all__ &#x3D; [&quot;echo&quot;, &quot;surround&quot;, &quot;reverse&quot;]</span><br></pre></td></tr></table></figure>

<p>这表示当你使用 <code>from sound.effects import *</code>这种用法时，你只会导入包里面这三个子模块。</p>
<p>如果 <code>__all__</code> 真的没有定义，那么使用<code>from sound.effects import *</code>这种语法的时候，就不会导入包 <code>sound.effects</code> 里的任何子模块。他只是把包 <code>sound.effects</code> 和它里面定义的所有内容导入进来（可能运行<code>__init__.py</code>里定义的初始化代码）。</p>
<p>这会把 <code>__init__.py</code> 里面定义的所有名字导入进来。并且他不会破坏掉我们在这句话之前导入的所有明确指定的模块。</p>
<p>7.练习题</p>
<p>1）怎么查出通过 from xx import xx导⼊的可以直接调⽤的⽅法？</p>
<p>方法1：通过 dir() 函数查看该模块中包含哪些成员：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> string</span><br><span class="line">print(dir(string))</span><br></pre></td></tr></table></figure>

<p>程序执行结果为：</p>
<p>[‘Formatter’, ‘Template’, ‘<em>ChainMap’, ‘<em>TemplateMetaclass’, ‘__all</em></em>‘, ‘<strong>builtins</strong>‘, ‘<strong>cached</strong>‘, ‘<strong>doc</strong>‘, ‘<strong>file</strong>‘, ‘<strong>loader</strong>‘, ‘<strong>name</strong>‘, ‘<strong>package</strong>‘, ‘<strong>spec</strong>‘, ‘_re’, ‘_string’, ‘ascii_letters’, ‘ascii_lowercase’, ‘ascii_uppercase’, ‘capwords’, ‘digits’, ‘hexdigits’, ‘octdigits’, ‘printable’, ‘punctuation’, ‘whitespace’]</p>
<p>​    通过 dir() 函数获取到的模块成员，不仅包含供外部文件使用的成员，还包含很多“特殊”（名称以 2 个下划线开头和结束）的成员，列出这些成员，对我们并没有实际意义。</p>
<p>​    可以忽略显示 dir() 函数输出的特殊成员的方法。仍以 string 模块为例：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> string</span><br><span class="line">print([e <span class="keyword">for</span> e <span class="keyword">in</span> dir(string) <span class="keyword">if</span> <span class="keyword">not</span> e.startswith(<span class="string">'_'</span>)])</span><br></pre></td></tr></table></figure>

<p>程序执行结果为：</p>
<p>[‘Formatter’, ‘Template’, ‘ascii_letters’, ‘ascii_lowercase’, ‘ascii_uppercase’, ‘capwords’, ‘digits’, ‘hexdigits’, ‘octdigits’, ‘printable’, ‘punctuation’, ‘whitespace’]</p>
<p>方法2：除了使用 dir() 函数之外，还可以使用<code>__all__</code>变量，借助该变量也可以查看模块（包）内包含的所有成员。</p>
<p>仍以 string 模块为例，举个例子：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> string</span><br><span class="line">print(string.__all__)</span><br></pre></td></tr></table></figure>

<p>程序执行结果为：</p>
<p>[‘ascii_letters’, ‘ascii_lowercase’, ‘ascii_uppercase’, ‘capwords’, ‘digits’, ‘hexdigits’, ‘octdigits’, ‘printable’, ‘punctuation’, ‘whitespace’, ‘Formatter’, ‘Template’]</p>
<p>​    显然，和 dir() 函数相比，<code>__all__</code>变量在查看指定模块成员时，它不会显示模块中的特殊成员，同时还会根据成员的名称进行排序显示。</p>
<p>​    不过需要注意的是，并非所有的模块都支持使用<code>__all__</code> 变量，因此对于获取有些模块的成员，就只能使用 dir() 函数。</p>
<p>方法3：在python交互解释器中使用help()查看，使用help函数查看里面的FUNCTIONS</p>
<p>2）了解Collection模块，编写程序以查询给定列表中最常见的元素。</p>
<p>题目说明：</p>
<p>输入：language = [‘PHP’, ‘PHP’, ‘Python’, ‘PHP’, ‘Python’, ‘JS’, ‘Python’, ‘Python’,’PHP’, ‘Python’]</p>
<p>输出：Python</p>
<p>方法1：利用字典dict来完成统计</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">most_element</span><span class="params">(language)</span>:</span></span><br><span class="line">    dic = &#123;&#125;</span><br><span class="line">    <span class="keyword">for</span> key <span class="keyword">in</span> language:</span><br><span class="line">        dic[key] = dic.get(key,<span class="number">0</span>)+<span class="number">1</span></span><br><span class="line">    d = sorted(dic.items(),key = <span class="keyword">lambda</span> i:i[<span class="number">1</span>], reverse=<span class="literal">True</span>)</span><br><span class="line">    rs = d[<span class="number">0</span>][<span class="number">0</span>]</span><br><span class="line">    <span class="keyword">return</span> rs</span><br><span class="line">language = [<span class="string">'PHP'</span>, <span class="string">'PHP'</span>, <span class="string">'Python'</span>, <span class="string">'PHP'</span>, <span class="string">'Python'</span>, <span class="string">'JS'</span>, <span class="string">'Python'</span>, <span class="string">'Python'</span>,<span class="string">'PHP'</span>, <span class="string">'Python'</span>]</span><br><span class="line"></span><br><span class="line">print(most_element(language))</span><br></pre></td></tr></table></figure>

<p>Python</p>
<p>方法2：利用Python的collection包下Counter的类</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">most_element</span><span class="params">(language)</span>:</span></span><br><span class="line">    <span class="keyword">from</span> collections <span class="keyword">import</span> Counter</span><br><span class="line">    d = Counter(language)</span><br><span class="line">    <span class="comment"># 取第一个出现频率最高的元素以及他的次数,返回的数据格式是列表里面嵌套元组</span></span><br><span class="line">    c = d.most_common(<span class="number">1</span>)</span><br><span class="line">    rs = c[<span class="number">0</span>][<span class="number">0</span>]</span><br><span class="line">    <span class="keyword">return</span> rs</span><br><span class="line">language = [<span class="string">'PHP'</span>, <span class="string">'PHP'</span>, <span class="string">'Python'</span>, <span class="string">'PHP'</span>, <span class="string">'Python'</span>, <span class="string">'JS'</span>, <span class="string">'Python'</span>, <span class="string">'Python'</span>,<span class="string">'PHP'</span>, <span class="string">'Python'</span>]</span><br><span class="line"></span><br><span class="line">print(most_element(language))</span><br></pre></td></tr></table></figure>

<p>Python</p>
<p><strong>datetime模块</strong></p>
<p>1.datatime类</p>
<p>1）<code>datetime.now(tz=None)</code> 获取当前的日期时间，输出顺序为：年、月、日、时、分、秒、微秒。引入datetime模块，调用时，要用datetime.datetime.now()。</p>
<p>2）<code>datetime.timestamp()</code> 获取以 1970年1月1日为起点记录的秒数。</p>
<p>3）<code>datetime.fromtimestamp(tz=None)</code> 使用 unixtimestamp 创建一个 datetime。</p>
<p>4）<code>datetime.strftime(fmt)</code> 格式化 datetime 对象。</p>
<p>5）datetime.date()  返回具有同样 year, month 和 day 值的date对象。</p>
<p>6）datetime.time()  返回具有同样 hour, minute, second, microsecond 和 fold 值的time对象。 tzinfo值为 <code>None</code>。 另请参见timetz()方法。</p>
<p>7）<code>datetime.year</code> 年</p>
<p>8）<code>datetime.month</code> 月</p>
<p>9）<code>datetime.day</code> 日</p>
<p>10）<code>datetime.hour</code> 小时</p>
<p>11）<code>datetime.minute</code> 分钟</p>
<p>12）<code>datetime.second</code> 秒</p>
<p>13）<code>datetime.isoweekday</code> 星期几</p>
<p>在处理含有字符串日期的数据集或表格时，我们需要一种自动解析字符串的方法，无论它是什么格式的，都可以将其转化为 datetime 对象。这时，就要使用到 dateutil 中的 parser 模块。from dateutil import parser</p>
<ul>
<li><code>parser.parse(timestr, parserinfo=None, **kwargs)</code></li>
</ul>
<p>2.date类</p>
<p><code>date.today()</code> 获取当前日期信息。datetime.date.today()</p>
<p>支持的运算：</p>
<table>
<thead>
<tr>
<th align="left">运算</th>
<th align="left">结果：</th>
</tr>
</thead>
<tbody><tr>
<td align="left"><code>date2 = date1 + timedelta</code></td>
<td align="left"><em>date2</em> 等于从 <em>date1</em> 减去 <code>timedelta.days</code> 天。 (1)</td>
</tr>
<tr>
<td align="left"><code>date2 = date1 - timedelta</code></td>
<td align="left">计算 <em>date2</em> 的值使得 <code>date2 + timedelta == date1</code>。 (2)</td>
</tr>
<tr>
<td align="left"><code>timedelta = date1 - date2</code></td>
<td align="left">(3)</td>
</tr>
<tr>
<td align="left"><code>date1 &lt; date2</code></td>
<td align="left">如果 <em>date1</em> 的时间在 <em>date2</em> 之前则认为 <em>date1</em> 小于 <em>date2</em> 。 (4)</td>
</tr>
</tbody></table>
<p>3.time类</p>
<p>datetime.time() 类   </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> datetime</span><br><span class="line"></span><br><span class="line">t = datetime.time(<span class="number">12</span>, <span class="number">9</span>, <span class="number">23</span>, <span class="number">12980</span>)</span><br><span class="line">print(t)  <span class="comment"># 12:09:23.012980</span></span><br><span class="line">print(type(t))  <span class="comment"># &lt;class 'datetime.time'&gt;</span></span><br></pre></td></tr></table></figure>

<p>4.timedelta类</p>
<p>​    <code>timedelta</code> 表示具体时间实例中的一段时间。你可以把它们简单想象成两个日期或时间之间的间隔。它常常被用来从 <code>datetime</code> 对象中添加或移除一段特定的时间。</p>
<p>​    如果将两个 datetime 对象相减，就会得到表示该时间间隔的 timedelta 对象。同样地，将两个时间间隔相减，可以得到另一个 timedelta 对象。</p>
<p>timedelta.days()   天数</p>
<p>timedelta.total_seconds()      秒数</p>
<p>5.时间格式转换</p>
<p>1）datetime转换为timestamp：调用timestamp()方法</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">from</span> datetime <span class="keyword">import</span> datetime</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>dt = datetime(<span class="number">2015</span>, <span class="number">4</span>, <span class="number">19</span>, <span class="number">12</span>, <span class="number">20</span>) <span class="comment"># 用指定日期时间创建datetime</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>dt.timestamp() <span class="comment"># 把datetime转换为timestamp</span></span><br><span class="line"><span class="number">1429417200.0</span></span><br></pre></td></tr></table></figure>

<p>注意：Python的timestamp是一个浮点数，整数位表示秒。</p>
<p>某些编程语言（如Java和JavaScript）的timestamp使用整数表示毫秒数，这种情况下只需要把timestamp除以1000就得到Python的浮点表示方法。</p>
<p>2）timestamp转换为datetime：fromtimestamp()方法</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">from</span> datetime <span class="keyword">import</span> datetime</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>t = <span class="number">1429417200.0</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>print(datetime.fromtimestamp(t))</span><br><span class="line"><span class="number">2015</span><span class="number">-04</span><span class="number">-19</span> <span class="number">12</span>:<span class="number">20</span>:<span class="number">00</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>print(datetime.utcfromtimestamp(t)) <span class="comment"># UTC时间，也可以直接转换到UTC标准时区的时间</span></span><br><span class="line"><span class="number">2015</span><span class="number">-04</span><span class="number">-19</span> <span class="number">04</span>:<span class="number">20</span>:<span class="number">00</span></span><br></pre></td></tr></table></figure>

<p>注意：timestamp是一个浮点数，它没有时区的概念，而datetime是有时区的。上述转换是在timestamp和本地时间做转换。本地时间是指当前操作系统设定的时区。</p>
<p>3）str转换为datetime：datetime.strptime()</p>
<p>很多时候，用户输入的日期和时间是字符串，要处理日期和时间，首先必须把str转换为datetime。转换方法是通过<code>datetime.strptime()</code>实现，需要一个日期和时间的格式化字符串：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">from</span> datetime <span class="keyword">import</span> datetime</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>cday = datetime.strptime(<span class="string">'2015-6-1 18:19:59'</span>, <span class="string">'%Y-%m-%d %H:%M:%S'</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>print(cday)</span><br><span class="line"><span class="number">2015</span><span class="number">-06</span><span class="number">-01</span> <span class="number">18</span>:<span class="number">19</span>:<span class="number">59</span></span><br></pre></td></tr></table></figure>

<p>字符串<code>&#39;%Y-%m-%d %H:%M:%S&#39;</code>规定了日期和时间部分的格式。注意转换后的datetime是没有时区信息的。</p>
<p>4）datetime转换为str：strftime()</p>
<p>如果已经有了datetime对象，要把它格式化为字符串显示给用户，就需要转换为str，转换方法是通过<code>strftime()</code>实现的，同样需要一个日期和时间的格式化字符串：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">from</span> datetime <span class="keyword">import</span> datetime</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>now = datetime.now()</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>print(now.strftime(<span class="string">'%a, %b %d %H:%M'</span>))</span><br><span class="line">Mon, May <span class="number">05</span> <span class="number">16</span>:<span class="number">28</span></span><br></pre></td></tr></table></figure>

<p>5）datetime加减</p>
<p>对日期和时间进行加减实际上就是把datetime往后或往前计算，得到新的datetime。加减可以直接用<code>+</code>和<code>-</code>运算符，不过需要导入<code>timedelta</code>这个类：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">from</span> datetime <span class="keyword">import</span> datetime, timedelta</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>now = datetime.now()</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>now</span><br><span class="line">datetime.datetime(<span class="number">2015</span>, <span class="number">5</span>, <span class="number">18</span>, <span class="number">16</span>, <span class="number">57</span>, <span class="number">3</span>, <span class="number">540997</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>now + timedelta(hours=<span class="number">10</span>)</span><br><span class="line">datetime.datetime(<span class="number">2015</span>, <span class="number">5</span>, <span class="number">19</span>, <span class="number">2</span>, <span class="number">57</span>, <span class="number">3</span>, <span class="number">540997</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>now - timedelta(days=<span class="number">1</span>)</span><br><span class="line">datetime.datetime(<span class="number">2015</span>, <span class="number">5</span>, <span class="number">17</span>, <span class="number">16</span>, <span class="number">57</span>, <span class="number">3</span>, <span class="number">540997</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>now + timedelta(days=<span class="number">2</span>, hours=<span class="number">12</span>)</span><br><span class="line">datetime.datetime(<span class="number">2015</span>, <span class="number">5</span>, <span class="number">21</span>, <span class="number">4</span>, <span class="number">57</span>, <span class="number">3</span>, <span class="number">540997</span>)</span><br></pre></td></tr></table></figure>

<p>可见，使用<code>timedelta</code>你可以很容易地算出前几天和后几天的时刻。</p>
<p>6）本地时间转换为UTC时间</p>
<p>本地时间是指系统设定时区的时间，例如北京时间是UTC+8:00时区的时间，而UTC时间指UTC+0:00时区的时间。</p>
<p>一个<code>datetime</code>类型有一个时区属性<code>tzinfo</code>，但是默认为<code>None</code>，所以无法区分这个<code>datetime</code>到底是哪个时区，除非强行给<code>datetime</code>设置一个时区：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">from</span> datetime <span class="keyword">import</span> datetime, timedelta, timezone</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>tz_utc_8 = timezone(timedelta(hours=<span class="number">8</span>)) <span class="comment"># 创建时区UTC+8:00</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>now = datetime.now()</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>now</span><br><span class="line">datetime.datetime(<span class="number">2015</span>, <span class="number">5</span>, <span class="number">18</span>, <span class="number">17</span>, <span class="number">2</span>, <span class="number">10</span>, <span class="number">871012</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>dt = now.replace(tzinfo=tz_utc_8) <span class="comment"># 强制设置为UTC+8:00</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>dt</span><br><span class="line">datetime.datetime(<span class="number">2015</span>, <span class="number">5</span>, <span class="number">18</span>, <span class="number">17</span>, <span class="number">2</span>, <span class="number">10</span>, <span class="number">871012</span>, tzinfo=datetime.timezone(datetime.timedelta(<span class="number">0</span>, <span class="number">28800</span>)))</span><br></pre></td></tr></table></figure>

<p>如果系统时区恰好是UTC+8:00，那么上述代码就是正确的，否则，不能强制设置为UTC+8:00时区。</p>
<p>7）时区转换</p>
<p>我们可以先通过<code>utcnow()</code>拿到当前的UTC时间，再转换为任意时区的时间：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 拿到UTC时间，并强制设置时区为UTC+0:00:</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>utc_dt = datetime.utcnow().replace(tzinfo=timezone.utc)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>print(utc_dt)</span><br><span class="line"><span class="number">2015</span><span class="number">-05</span><span class="number">-18</span> <span class="number">09</span>:<span class="number">05</span>:<span class="number">12.377316</span>+<span class="number">00</span>:<span class="number">00</span></span><br><span class="line"><span class="comment"># astimezone()将转换时区为北京时间:</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>bj_dt = utc_dt.astimezone(timezone(timedelta(hours=<span class="number">8</span>)))</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>print(bj_dt)</span><br><span class="line"><span class="number">2015</span><span class="number">-05</span><span class="number">-18</span> <span class="number">17</span>:<span class="number">05</span>:<span class="number">12.377316</span>+<span class="number">08</span>:<span class="number">00</span></span><br><span class="line"><span class="comment"># astimezone()将转换时区为东京时间:</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>tokyo_dt = utc_dt.astimezone(timezone(timedelta(hours=<span class="number">9</span>)))</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>print(tokyo_dt)</span><br><span class="line"><span class="number">2015</span><span class="number">-05</span><span class="number">-18</span> <span class="number">18</span>:<span class="number">05</span>:<span class="number">12.377316</span>+<span class="number">09</span>:<span class="number">00</span></span><br><span class="line"><span class="comment"># astimezone()将bj_dt转换时区为东京时间:</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>tokyo_dt2 = bj_dt.astimezone(timezone(timedelta(hours=<span class="number">9</span>)))</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>print(tokyo_dt2)</span><br><span class="line"><span class="number">2015</span><span class="number">-05</span><span class="number">-18</span> <span class="number">18</span>:<span class="number">05</span>:<span class="number">12.377316</span>+<span class="number">09</span>:<span class="number">00</span></span><br></pre></td></tr></table></figure>

<p>时区转换的关键在于，拿到一个<code>datetime</code>时，要获知其正确的时区，然后强制设置时区，作为基准时间。利用带时区的<code>datetime</code>，通过<code>astimezone()</code>方法，可以转换到任意时区。</p>
<p>注：不是必须从UTC+0:00时区转换到其他时区，任何带时区的<code>datetime</code>都可以正确转换，例如上述<code>bj_dt</code>到<code>tokyo_dt</code>的转换。</p>
<p>5.练习题</p>
<p>1）假设你获取了用户输入的日期和时间如<code>2020-1-21 9:01:30</code>，以及一个时区信息如<code>UTC+5:00</code>，均是<code>str</code>，请编写一个函数将其转换为timestamp：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">"""</span></span><br><span class="line"><span class="string">   </span></span><br><span class="line"><span class="string">Input file</span></span><br><span class="line"><span class="string">example1: dt_str='2020-6-1 08:10:30', tz_str='UTC+7:00'</span></span><br><span class="line"><span class="string">example2: dt_str='2020-5-31 16:10:30', tz_str='UTC-09:00'</span></span><br><span class="line"><span class="string">   </span></span><br><span class="line"><span class="string">Output file</span></span><br><span class="line"><span class="string">result1: 1590973830.0</span></span><br><span class="line"><span class="string">result2: 1590973830.0</span></span><br><span class="line"><span class="string">"""</span></span><br><span class="line">   </span><br><span class="line"><span class="keyword">from</span> datetime <span class="keyword">import</span> datetime,timedelta,timezone</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">to_timestamp</span><span class="params">(dt_str, tz_str)</span>:</span></span><br><span class="line">    dt = datetime.strptime(dt_str, <span class="string">'%Y-%m-%d %H:%M:%S'</span>)</span><br><span class="line">    <span class="comment"># 转换后的datetime是没有时区信息的，需要设置时区</span></span><br><span class="line">    <span class="comment"># 通过正则获取用户输入的时区</span></span><br><span class="line">    time_zone_num = re.match(<span class="string">r'UTC([+|-][\d]&#123;1,2&#125;):00'</span>,tz_str).group(<span class="number">1</span>)</span><br><span class="line">    tz_utc = timezone(timedelta(hours=int(time_zone_num)))</span><br><span class="line">    <span class="comment"># 将用户输入的时间强制设置为输入的时区，给tzinfo属性赋值</span></span><br><span class="line">    dt1 = dt.replace(tzinfo=tz_utc)</span><br><span class="line">    <span class="comment"># 转换为timestamp</span></span><br><span class="line">    dt2 = dt1.timestamp()</span><br><span class="line">    <span class="keyword">return</span> dt2</span><br><span class="line"></span><br><span class="line">dt_str=<span class="string">'2020-6-1 08:10:30'</span></span><br><span class="line">tz_str=<span class="string">'UTC+7:00'</span></span><br><span class="line">print(to_timestamp(dt_str,tz_str))</span><br><span class="line"></span><br><span class="line">dt_str=<span class="string">'2020-5-31 16:10:30'</span></span><br><span class="line">tz_str=<span class="string">'UTC-09:00'</span></span><br><span class="line">print(to_timestamp(dt_str,tz_str))</span><br></pre></td></tr></table></figure>

<p>1590973830.0<br>1590973830.0</p>
<p>2）编写Python程序以选择指定年份的所有星期日。</p>
<p>题目说明:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> datetime <span class="keyword">import</span> datetime,timedelta,date</span><br><span class="line">a = int(input())</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">all_sundays</span><span class="params">(year)</span>:</span></span><br><span class="line">    dt1 = date(year,<span class="number">1</span>,<span class="number">1</span>)</span><br><span class="line">    dt2 = date(year,<span class="number">12</span>,<span class="number">31</span>)</span><br><span class="line">    td = (dt2-dt1).days</span><br><span class="line">    a = dt1.isoweekday()</span><br><span class="line">    i = <span class="number">7</span>-a</span><br><span class="line">    <span class="keyword">while</span> i&lt;=td:</span><br><span class="line">        day = dt1 + timedelta(days=i)</span><br><span class="line">        print(day)</span><br><span class="line">        i += <span class="number">7</span></span><br><span class="line"></span><br><span class="line">all_sundays(a)</span><br></pre></td></tr></table></figure>

<p>2020<br>2020-01-05<br>2020-01-12<br>2020-01-19<br>2020-01-26<br>2020-02-02<br>2020-02-09<br>2020-02-16<br>2020-02-23<br>2020-03-01<br>2020-03-08<br>2020-03-15<br>2020-03-22<br>2020-03-29<br>2020-04-05<br>2020-04-12<br>2020-04-19<br>2020-04-26<br>2020-05-03<br>2020-05-10<br>2020-05-17<br>2020-05-24<br>2020-05-31<br>2020-06-07<br>2020-06-14<br>2020-06-21<br>2020-06-28<br>2020-07-05<br>2020-07-12<br>2020-07-19<br>2020-07-26<br>2020-08-02<br>2020-08-09<br>2020-08-16<br>2020-08-23<br>2020-08-30<br>2020-09-06<br>2020-09-13<br>2020-09-20<br>2020-09-27<br>2020-10-04<br>2020-10-11<br>2020-10-18<br>2020-10-25<br>2020-11-01<br>2020-11-08<br>2020-11-15<br>2020-11-22<br>2020-11-29<br>2020-12-06<br>2020-12-13<br>2020-12-20<br>2020-12-27</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2020/08/07/Python-Task08/" data-id="ckdjx2wel0000r0wc99eqej1t" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2020/08/07/Python-Task09/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          Python-Task09
        
      </div>
    </a>
  
  
    <a href="/2020/08/05/Python-Task07/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">Python-Task07</div>
    </a>
  
</nav>

  
</article>

</section>
        
          <aside id="sidebar">
  
    

  
    

  
    
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/08/">August 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/07/">July 2020</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2020/08/19/Leetcode-Task01/">Leetcode-Task01</a>
          </li>
        
          <li>
            <a href="/2020/08/07/Python-Task09/">Python-Task09</a>
          </li>
        
          <li>
            <a href="/2020/08/07/Python-Task08/">Python-Task08</a>
          </li>
        
          <li>
            <a href="/2020/08/05/Python-Task07/">Python-Task07</a>
          </li>
        
          <li>
            <a href="/2020/08/04/NLP-Task06/">NLP-Task06</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2020 John Doe<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  
<link rel="stylesheet" href="/fancybox/jquery.fancybox.css">

  
<script src="/fancybox/jquery.fancybox.pack.js"></script>




<script src="/js/script.js"></script>




  </div>
</body>
</html>